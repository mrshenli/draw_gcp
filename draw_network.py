import matplotlib.pyplot as plt
import numpy as np


FONT = {'fontname':'Times New Roman', 'size':12}
FIG_TYPE = "pdf"

INF = float("inf")

# 8 GPUs in total, 4 Machines, 2GPU per machine

ddp = [
  [125,   350,   760,   1300,  2700,  6700,  13000, 39000,  76000],  # model size
  [0.26,  0.73,  1.50,  2.18,  4.31,  0.00,  INF,   INF,    INF],    # bs=8
  [2195,  4872,  7581,  11355, 20267, 0000,  INF,   INF,    INF],    # mem
  [0.26,  0.72,  1.35,  2.77,  4.45,  INF,   INF,   INF,    INF],    # bs=16
  [3625,  8014,  11554, 16748, 17435, INF,   INF,   INF,    INF],
  [0.30,  0.90,  1.47,  2.98,  4.63,  INF,   INF,   INF,    INF],    # bs=32
  [6506,  14031, 19567, 27592, 18516, INF,   INF,   INF,    INF],
  [0.35,  0.81,  1.44,  3.47,  5.40,  INF,   INF,   INF,    INF],    # bs=64
  [12265, 26872, 35590, 12723, 20677, INF,   INF,   INF,    INF],
  [0.44,  1.06,  1.78,  3.77,  6.01,  INF,   INF,   INF,    INF],    # bs=128
  [23789, 13406, 16142, 19505, 27214, INF,   INF,   INF,    INF],
  [0.00,  1.91,  0.00,  6.71,  INF,   INF,   INF,   INF,    INF],    # bs=256
  [0000,  25079, 0000,  33050, INF,   INF,   INF,   INF,    INF],
]

fsdp = [
  [125,   350,   760,   1300,  2700,  6700,  13000, 39000,  76000],  # model size
  [INF,   INF,   2.14,  4.04,  7.01,  16.10, 0.00,  0.00,   0.00],   # bs=8
  [INF,   INF,   4768,  6510,  10772, 16673, 0000,  0000,   0000],   # mem
  [INF,   INF,   2.01,  4.25,  7.05,  19.13, 0.00,  0.00,   0.00],   # bs=16
  [INF,   INF,   8721,  11908, 19546, 28764, 0000,  0000,   0000],   # mem
  [INF,   INF,   2.18,  4.26,  8.96,  25.49, 0.00,  0.00,   0.00],   # bs=32
  [INF,   INF,   16735, 22756, 37219, 8535,  0000,  0000,   0000],   # mem
  [INF,   INF,   2.26,  5.78,  10.69, 24.97, 0.00,  0.00,   0.00],   # bs=64
  [INF,   INF,   23757, 6244,  8414,  9219,  0000,  0000,   0000],   # mem
  [INF,   INF,   3.49,  6.26,  10.78, 26.05, 0.00,  0.00,   0.00],   # bs=128
  [INF,   INF,   10032, 11432, 10138, 14750, 0000,  0000,   0000],   # mem
  [INF,   INF,   4.07,  9.23,  13.62, 41.06, 0.00,  0.00,   0.00],   # bs=256
  [INF,   INF,   19352, 22068, 29185, 25809, 0000,  0000,   0000],
]
